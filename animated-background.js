class ParticleSystem{constructor(){this.container=document.getElementById("particles"),this.container?(this.particles=[],this.maxParticles=window.innerWidth<768?12:18,this.animationId=null,this.isVisible=!0,this.init(),this.setupVisibilityOptimization()):console.error("Particles container not found")}init(){this.createParticles(),this.scheduleNextParticle()}createParticles(){let t=0;const e=()=>{const i=Math.min(t+3,this.maxParticles);for(let e=t;e<i;e++)setTimeout(()=>this.createParticle(),800*e);t=i,t<this.maxParticles&&setTimeout(e,50)};e()}createParticle(){if(!this.isVisible||!this.container)return;const t=document.createElement("div");t.className="particle";const e=4*Math.random()+2,i=Math.floor(4*Math.random()),s=12*Math.random()+8,a=200*(Math.random()-.5),n={width:e+"px",height:e+"px",opacity:.6*Math.random()+.4};let r,o;switch(Object.assign(t.style,n),t.style.setProperty("--drift",a+"px"),i){case 0:r=Math.random()*window.innerWidth,t.style.left=r+"px",t.style.top="-10px",o="particleFromTop";break;case 1:r=Math.random()*window.innerHeight,t.style.right="-10px",t.style.top=r+"px",o="particleFromRight";break;case 2:r=Math.random()*window.innerWidth,t.style.left=r+"px",t.style.bottom="-10px",o="particleFromBottom";break;case 3:r=Math.random()*window.innerHeight,t.style.left="-10px",t.style.top=r+"px",o="particleFromLeft"}t.style.animation=`${o} ${s}s linear forwards`,this.container.appendChild(t),this.particles.push(t),setTimeout(()=>{if(t.parentNode){t.parentNode.removeChild(t);const e=this.particles.indexOf(t);e>-1&&this.particles.splice(e,1)}},1e3*s)}scheduleNextParticle(){if(this.isVisible){const t=2e3*Math.random()+1e3;setTimeout(()=>{this.createParticle(),this.scheduleNextParticle()},t)}}setupVisibilityOptimization(){document.addEventListener("visibilitychange",()=>{this.isVisible=!document.hidden,this.isVisible&&this.scheduleNextParticle()})}destroy(){this.isVisible=!1,this.particles.forEach(t=>{t.parentNode&&t.parentNode.removeChild(t)}),this.particles=[]}}let resizeTimeout;document.addEventListener("DOMContentLoaded",()=>{console.log("Initializing particle system..."),window.particleSystem=new ParticleSystem}),window.addEventListener("resize",()=>{clearTimeout(resizeTimeout),resizeTimeout=setTimeout(()=>{const t=window.innerWidth;if(Math.abs(t-(window.lastWidth||0))>100){window.lastWidth=t,window.particleSystem&&window.particleSystem.destroy();const e=document.getElementById("particles");e&&(e.innerHTML="",window.particleSystem=new ParticleSystem)}},500)});